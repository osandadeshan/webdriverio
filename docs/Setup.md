# Set Up Project

WebdriverIO is a basic Node.js project that doesn't need much setup nor has other specific requirements. You can either develop it [locally](#local-development) or using an [ephemeral workspace](#remote-development) in the cloud.

## Local Development

If you like to develop on the project locally follow this step by step guide:

### Get the Code

Fork the project by cloning it somewhere on your computer

```sh
$ git clone git@github.com:<your-username>/webdriverio.git
$ cd ./webdriverio
```

On Windows, you need to set git config `core.symlinks` to `true` as we currently have some symbolic links for type definition committed to our repo.
  - To set git config globally: `git config --global --add core.symlinks true`
  - To set git config locally when cloning the repo: `git -c core.symlinks=true clone git@github.com:<your-username>/webdriverio.git`.

See [https://github.com/git-for-windows/git/wiki/Symbolic-Links](https://github.com/git-for-windows/git/wiki/Symbolic-Links) for more information

If you need to update your fork you can do so following the steps [here](https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/syncing-a-fork)

Switch to the most recent Node LTS (you should be able to use older/newer versions of Node but we recommend to use v18 LTS so all developers are on the same side) or to the one denoted in `.nvmrc`. We recommend to use [`nvm`](https://github.com/nvm-sh/nvm) to switch between Node.js versions.

### Set up the project

First make sure you have the right Node.js version installed. You can find the current defined development version in `.nvmrc` within the root directory of the project. The easiest way to handle multiple Node.js versions is by using [NVM](https://github.com/nvm-sh/nvm).

After it is installed you can run:

```sh
$ nvm install
$ npm install
```

This will install the defined Node.js version for you. You can then go ahead and set-up the project via:

```sh { name=setup }
npx runme2 clean bootstrap link generateTypings compile copyTemplates
```

This will:

- *Cleanup*

  If you have compiled the code this command will remove them as well as all dependencies of the subpackages.

  ```sh { name=clean }
  $ npx rimraf './packages/*/package-lock.json'
  $ npx rimraf './packages/*/*.tgz'
  $ npx rimraf './packages/*/build'
  $ npx rimraf './packages/*/node_modules'
  $ npx rimraf './packages/node_modules'
  ```

- *Bootstrap via Lerna*

  Many packages depend on each other, in order to properly set up the dependency tree you need to run the [Lerna Bootstrap](https://github.com/lerna/lerna#bootstrap) command to create all necessary links. As this project also does some other house keeping tasks, it is recommended to use the package bootstrap command.

  ```sh { name=bootstrap }
  npx lerna bootstrap --no-ci
  ```

- *Link Packages for Local Development*
  ```sh { name=link }
  node ./scripts/link.js
  ```

- *Generate Types from WebDriver Protocols*
  ```sh
  npx runme2 generateTypings
  ```

- *Compile TypeScript*

  Next, you need to build all sub-packages in order to resolve the internal dependencies. WebdriverIO uses [TypeScript](https://www.typescriptlang.org/) as a compiler. A custom build script helps to compile the packages in the right order.

  ```sh { name=compile }
  node ./scripts/build.js
  ```

- *Copy Templates in `@wdio/cli` Package*
  ```sh { name=copyTemplates }
  cd packages/wdio-cli
  npm run copy
  cd ../../
  ```

#### TypeScript Definitions

WebdriverIO uses TypeScript to ensure that code is statically typed and common mistakes misusing them are avoided. If you are new to TypeScript have a look at [these awesome essential resources](https://github.com/dzharii/awesome-typescript#awesome-typescript-essential-resources) to get started with it.

WebdriverIO provides its own type definitions for projects that use TypeScript. Given the large amount of commands it would make it unmaintainable to __not__ automate the process of generating these. However there are certain edge cases where manual work is required.

All type definitions are generated by the TypeScript compiler. There are some essential packages for that:

- the `@wdio/types` package provides all general types that are used across the code based, e.g. Capabilities, Options etc. If you need a type definitions across multiple packages it is a good idea to define them in here
- the `@wdio/protocol` package defines all protocol commands, their function parameters and return types
- all other types should be defined in the package where they are used, here we tend to have general types defined in a `types.ts` file

You can find all files responsible for the generating the typings [here](https://github.com/webdriverio/webdriverio/tree/main/scripts/type-generation). You can trigger the process by calling:

```sh { name=generateTypings }
npx ts-node-esm ./scripts/type-generation/generate-all-typings.ts
```

This will run the scripts in the directory shown above and generate the typings for all protocol commands. Whenever you change those [protocol commands](https://github.com/webdriverio/webdriverio/tree/main/packages/wdio-protocols/src/protocols), make sure you re-generate the types with the command shown above.

## Remote Development

WebdriverIO offers using different services with pre-setup dev environments for you to get started without any efforts. Read more on developing WebdriverIO remotely in this [blog post](https://bromann.dev/post/development-environment-for-webdriverio/).

### Getting started with GitHub Codespaces

To get started, create a codespace for this repository by clicking this ðŸ‘‡

[![Open in GitHub Codespaces](https://github.com/codespaces/badge.svg)](https://github.com/codespaces/new?hide_repo_select=true&ref=main&repo=2296970)

A codespace will open in a web-based version of Visual Studio Code. The [dev container](.devcontainer/devcontainer.json) is fully configured with software needed for this project.

**Note**: Dev containers is an open spec which is supported by [GitHub Codespaces](https://github.com/codespaces) and [other tools](https://containers.dev/supporting).

### Getting started with Gitpod

You can also just click on:

[![Open in Gitpod](https://gitpod.io/button/open-in-gitpod.svg)](https://gitpod.io/#https://github.com/webdriverio/webdriverio)

to get a ready-to-use development environment for you to start working on this code base.

If you're looking for issues to help out with, check out [the issues labeled "good first pick"](https://github.com/webdriverio/webdriverio/issues?q=is%3Aopen+is%3Aissue+label%3A"good+first+pick"). You can also reach out to our [Matrix Channel](https://discord.webdriver.io) if you have questions on where to start contributing.

## Setup Git Hooks

WebdriverIO uses [Husky](https://typicode.github.io/husky/#/) to set up its git hooks. This happens automatically after you installed the Node Dependencies.

```sh { name=husky }
npx husky install
```
